This is taken from the Warrant serverless authentication library
https://github.com/capless/warrant
